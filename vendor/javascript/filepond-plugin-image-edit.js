var e={};(function(t,i){e=i()})(0,(function(){var e=function isPreviewableImage(e){return/^image/.test(e.type)};var t=function plugin(t){var i=t.addFilter,r=t.utils,a=t.views;var n=r.Type,o=r.createRoute,l=r.createItemAPI,d=void 0===l?function(e){return e}:l;var E=a.fileActionButton;i("SHOULD_REMOVE_ON_REVERT",(function(t,i){var r=i.item,a=i.query;return new Promise((function(t){var i=r.file;var n=a("GET_ALLOW_IMAGE_EDIT")&&a("GET_IMAGE_EDIT_ALLOW_EDIT")&&e(i);t(!n)}))}));i("DID_LOAD_ITEM",(function(t,i){var r=i.query,a=i.dispatch;return new Promise((function(i,n){if(t.origin>1)i(t);else{var o=t.file;if(r("GET_ALLOW_IMAGE_EDIT")&&r("GET_IMAGE_EDIT_INSTANT_EDIT"))if(e(o)){var l=function createEditorResponseHandler(e,t,i){return function(r){u.shift();r?t(e):i(e);a("KICK");d()}};var d=function requestEdit(){if(u.length){var e=u[0],t=e.item,i=e.resolve,r=e.reject;a("EDIT_ITEM",{id:t.id,handleEditorResponse:l(t,i,r)})}};c({item:t,resolve:i,reject:n});1===u.length&&d()}else i(t);else i(t)}}))}));i("DID_CREATE_ITEM",(function(e,t){t.query;var i=t.dispatch;e.extend("edit",(function(){i("EDIT_ITEM",{id:e.id})}))}));var u=[];var c=function queueEditRequest(e){u.push(e);return e};i("CREATE_VIEW",(function(t){var i=t.is,r=t.view,a=t.query;if(a("GET_ALLOW_IMAGE_EDIT")){var n=a("GET_ALLOW_IMAGE_PREVIEW");var l=i("file-info")&&!n||i("file")&&n;if(l){var u=a("GET_IMAGE_EDIT_EDITOR");if(u){if(!u.filepondCallbackBridge){u.outputData=true;u.outputFile=false;u.filepondCallbackBridge={onconfirm:u.onconfirm||function(){},oncancel:u.oncancel||function(){}}}var c=function openEditor(e){var t=e.root,i=e.props,r=e.action;var a=i.id;var n=r.handleEditorResponse;u.cropAspectRatio=t.query("GET_IMAGE_CROP_ASPECT_RATIO")||u.cropAspectRatio;u.outputCanvasBackgroundColor=t.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR")||u.outputCanvasBackgroundColor;var o=t.query("GET_ITEM",a);if(o){var l=o.file;var E=o.getMetadata("crop");var c={center:{x:.5,y:.5},flip:{horizontal:false,vertical:false},zoom:1,rotation:0,aspectRatio:null};var f=o.getMetadata("resize");var s=o.getMetadata("filter")||null;var I=o.getMetadata("filters")||null;var _=o.getMetadata("colors")||null;var v=o.getMetadata("markup")||null;var T={crop:E||c,size:f?{upscale:f.upscale,mode:f.mode,width:f.size.width,height:f.size.height}:null,filter:I?I.id||I.matrix:t.query("GET_ALLOW_IMAGE_FILTER")&&t.query("GET_IMAGE_FILTER_COLOR_MATRIX")&&!_?s:null,color:_,markup:v};u.onconfirm=function(e){var t=e.data;var i=t.crop,r=t.size,a=t.filter,l=t.color,E=t.colorMatrix,c=t.markup;var f={};i&&(f.crop=i);if(r){var s=(o.getMetadata("resize")||{}).size;var I={width:r.width,height:r.height};if(!(I.width&&I.height)&&s){I.width=s.width;I.height=s.height}(I.width||I.height)&&(f.resize={upscale:r.upscale,mode:r.mode,size:I})}c&&(f.markup=c);f.colors=l;f.filters=a;f.filter=E;o.setMetadata(f);u.filepondCallbackBridge.onconfirm(t,d(o));n&&(u.onclose=function(){n(true);u.onclose=null})};u.oncancel=function(){u.filepondCallbackBridge.oncancel(d(o));n&&(u.onclose=function(){n(false);u.onclose=null})};u.open(l,T)}};var f=function didLoadItem(t){var i=t.root,o=t.props;if(a("GET_IMAGE_EDIT_ALLOW_EDIT")){var l=o.id;var d=a("GET_ITEM",l);if(d){var u=d.file;if(e(u)){i.ref.handleEdit=function(e){e.stopPropagation();i.dispatch("EDIT_ITEM",{id:l})};if(n){var c=r.createChildView(E,{label:"edit",icon:a("GET_IMAGE_EDIT_ICON_EDIT"),opacity:0});c.element.classList.add("filepond--action-edit-item");c.element.dataset.align=a("GET_STYLE_IMAGE_EDIT_BUTTON_EDIT_ITEM_POSITION");c.on("click",i.ref.handleEdit);i.ref.buttonEditItem=r.appendChildView(c)}else{var f=r.element.querySelector(".filepond--file-info-main");var s=document.createElement("button");s.className="filepond--action-edit-item-alt";s.innerHTML=a("GET_IMAGE_EDIT_ICON_EDIT")+"<span>edit</span>";s.addEventListener("click",i.ref.handleEdit);f.appendChild(s);i.ref.editButton=s}}}}};r.registerDestroyer((function(e){var t=e.root;t.ref.buttonEditItem&&t.ref.buttonEditItem.off("click",t.ref.handleEdit);t.ref.editButton&&t.ref.editButton.removeEventListener("click",t.ref.handleEdit)}));var s={EDIT_ITEM:c,DID_LOAD_ITEM:f};if(n){var I=function didPreviewUpdate(e){var t=e.root;t.ref.buttonEditItem&&(t.ref.buttonEditItem.opacity=1)};s.DID_IMAGE_PREVIEW_SHOW=I}r.registerWriter(o(s))}}}}));return{options:{allowImageEdit:[true,n.BOOLEAN],styleImageEditButtonEditItemPosition:["bottom center",n.STRING],imageEditInstantEdit:[false,n.BOOLEAN],imageEditAllowEdit:[true,n.BOOLEAN],imageEditIconEdit:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M8.5 17h1.586l7-7L15.5 8.414l-7 7V17zm-1.707-2.707l8-8a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1 0 1.414l-8 8A1 1 0 0 1 10.5 19h-3a1 1 0 0 1-1-1v-3a1 1 0 0 1 .293-.707z" fill="currentColor" fill-rule="nonzero"/></svg>',n.STRING],imageEditEditor:[null,n.OBJECT]}}};var i="undefined"!==typeof window&&"undefined"!==typeof window.document;i&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:t}));return t}));var t=e;export default t;

